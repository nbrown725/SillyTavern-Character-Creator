<div id="chat_container" style="display:none;">
    <div class="chat-header">
        <h3>Character Brainstorming Chat</h3>
        <div class="chat-actions">
            <button id="clear_chat" class="menu_button" title="Clear chat history">
                <i class="fa-solid fa-trash"></i> Clear
            </button>
            <button id="export_chat" class="menu_button" title="Export chat history">
                <i class="fa-solid fa-download"></i> Export
            </button>
        </div>
    </div>

    <div id="chat_messages" class="chat-messages">
        <!-- Messages will be dynamically added here -->
    </div>

    <div class="chat-input-container">
        <div class="chat-image-preview-container" style="display:none; margin-bottom: 6px;">
            <img id="chat_image_preview" src="" alt="image preview" style="max-width: 160px; max-height: 120px; border: 1px solid var(--SmartThemeBorderColor); border-radius: 4px; margin-right: 8px;" />
            <button id="clear_image" class="menu_button" title="Remove image"><i class="fa-solid fa-xmark"></i> Remove</button>
        </div>
        <textarea id="chat_input" class="text_pole chat-input" placeholder="Type your message here..."
            rows="3"></textarea>
        <div class="chat-input-actions" style="display:flex; gap: 6px; align-items: center;">
            <button id="attach_image" class="menu_button" title="Attach image">
                <i class="fa-solid fa-image"></i> Image
            </button>
            <input id="chat_image_input" type="file" accept="image/*" style="display:none;" />
            <button id="send_message" class="menu_button" title="Send message">
                <i class="fa-solid fa-paper-plane"></i> Send
            </button>
        </div>
    </div>
</div>

<!-- Template for chat messages -->
<template id="chat_message_template">
    <div class="chat-message" data-message-id="">
        <div class="message-header">
            <div class="message-info">
                <span class="message-role"></span>
                <span class="message-timestamp"></span>
            </div>
            <div class="message-actions">
                <button class="message-action-btn edit-message-btn" title="Edit message">
                    <i class="fa-solid fa-pen-to-square"></i>
                </button>
                <button class="message-action-btn delete-message-btn" title="Delete message">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </div>
        </div>
        <div class="message-content"></div>
        <div class="message-edit-container" style="display: none;">
            <textarea class="message-edit-textarea text_pole" rows="3"></textarea>
            <div class="message-edit-actions">
                <button class="menu_button save-edit-btn">
                    <i class="fa-solid fa-check"></i> Save
                </button>
                <button class="menu_button cancel-edit-btn">
                    <i class="fa-solid fa-xmark"></i> Cancel
                </button>
            </div>
        </div>
    </div>
</template>